```{r data_methodology, results=FALSE, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning=FALSE)
rm(list=ls())
load("RiskIndex.rda")
RI<-da36341.0001
RI.ts<-as.ts(RI)
library(tidyverse)
library(car)
library(sandwich)
library(plm)
library(dynlm)
library(nlme)
library(lmtest)
library(stargazer)
Obama1<-as.factor(RI$TRUSTOBAMA1)
CONGRESS1<-as.factor(RI$TRUSTCONGRESS1)
CEO1<-as.factor(RI$TRUSTCEO1)
Obama3<-as.factor(RI$TRUSTOBAMA3)
CONGRESS3<-as.factor(RI$TRUSTCONGRESS3)
CEO3<-as.factor(RI$TRUSTCEO3)
Obama5<-as.factor(RI$TRUSTOBAMA5)
CONGRESS5<-as.factor(RI$TRUSTCONGRESS5)
CEO5<-as.factor(RI$TRUSTCEO5)
Obama7<-as.factor(I$TRUSTOBAMA7)
CONGRESS7<-as.factor(RI$TRUSTCONGRESS7)
CEO7<-as.factor(RI$TRUSTCEO7)
Race<-as.factor(RI$RACE)
Age<-as.numeric(RI$AGE)
TREAS1<-as.factor(RI$TRUSTTREAS1)
Income<-as.numeric(RI$INCOME)
Party<-as.factor(RI$AFFILIATION)
Educ<-as.factor(RI$EDUCATION)
```{r Granger Test: TREAS/CEO, results=TRUE, echo=FALSE}
grangertest(CEO1,TREAS1)
grangertest(TREAS1, CEO1)
```{r CONFIDENCE Measure, results=TRUE, echo=FALSE}
j1<-dynlm(RISKPERCEPTIONINDEX1~FINEMOTINDEX1+LIPKUS11+Race+GENDER+Income+CEO1+CONGRESS1+Obama1, data=RI.ts)
summary(j1)
j2<-dynlm(RISKPERCEPTIONINDEX3~FINEMOTINDEX3+LIPKUS11+Race+GENDER+Income+CEO3+CONGRESS3+Obama3, data=RI.ts)
summary(j2)
j3<-dynlm(RISKPERCEPTIONINDEX5~FINEMOTINDEX5+LIPKUS11+Race+GENDER+Income+CEO5+CONGRESS5+Obama5, data=RI.ts)
summary(j3)
j4<-dynlm(RISKPERCEPTIONINDEX7~FINEMOTINDEX7+LIPKUS11+Race+GENDER+Income+CEO7+CONGRESS7+Obama7, data=RI.ts)
summary(j4)
```{r Granger Causality, results=TRUE, echo=FALSE}
j.dynlm1<-dynlm(RISKPERCEPTIONINDEX1~FINEMOTINDEX1, data=RI.ts)
summary(j.dynlm1)
j.dynlm2<-dynlm(FINEMOTINDEX1~RISKPERCEPTIONINDEX1, data=RI.ts)
summary(j.dynlm2)
grangertest(RI$RISKPERCEPTIONINDEX1, RI$FINEMOTINDEX1)
grangertest(RI$RISKPERCEPTIONINDEX3, RI$FINEMOTINDEX3)
grangertest(RI$RISKPERCEPTIONINDEX5, RI$FINEMOTINDEX5)
grangertest(RI$RISKPERCEPTIONINDEX7, RI$FINEMOTINDEX7)
grangertest(RI$FINEMOTINDEX1, RI$RISKPERCEPTIONINDEX1)
grangertest(RI$FINEMOTINDEX3, RI$RISKPERCEPTIONINDEX3)
grangertest(RI$FINEMOTINDEX5, RI$RISKPERCEPTIONINDEX5)
grangertest(RI$FINEMOTINDEX7, RI$RISKPERCEPTIONINDEX7)
```{r DYNLM results, results=TRUE, echo=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning=FALSE)
j5<-dynlm(RISKPERCEPTIONINDEX1~Race+LIPKUS11+GENDER+Income+CEO1+CONGRESS1+Obama1, data=RI.ts)
summary(j5)
j6<-dynlm(RISKPERCEPTIONINDEX3~Race+LIPKUS11+GENDER+Income+CEO5+CONGRESS3+Obama3, data=RI.ts)
summary(j6)
j7<-dynlm(RISKPERCEPTIONINDEX5~Race+LIPKUS11+GENDER+Income+CEO5+CONGRESS5+Obama5, data=RI.ts)
summary(j7)
j8<-dynlm(RISKPERCEPTIONINDEX7~Race+LIPKUS11+GENDER+Income+CEO7+CONGRESS7+Obama7, data=RI.ts)
summary(j8)
```{r OLS, results=FALSE, echo=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning=FALSE)
summary(j.ols1<-lm(RISKPERCEPTIONINDEX1~Race+LIPKUS11+GENDER+Income+CEO1+CONGRESS1+Obama1, data=RI))
summary(j.ols2<-lm(RISKPERCEPTIONINDEX1~Race+LIPKUS11+GENDER+Income+CEO3+CONGRESS3+Obama3, data=RI))
summary(j.ols3<-lm(RISKPERCEPTIONINDEX5~Race+LIPKUS11+GENDER+Income+CEO5+CONGRESS5+Obama5, data=RI))
summary(j.ols4<-lm(RISKPERCEPTIONINDEX7~Race+LIPKUS11+GENDER+Income+CEO7+CONGRESS7+Obama7, data=RI))
```
```{r OLS vs. DYNLM, results=TRUE, echo=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning=FALSE)
stargazer(j1,j5,j.ols1, type= "text")
stargazer(j2,j6,j.ols2, type= "text")
stargazer(j3,j7,j.ols3, type= "text")
stargazer(j4,j8,j.ols4, type= "text")
##Wave 1 vs. Wave 7 plots             
```{r visible plots, echo=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning=FALSE)
plot(RI$GENDER, RI$RISKPERCEPTIONINDEX1, type="n", xlab= "Gender", ylab="RPI scores 1", main= "RPI Scores by Gender Wave 1") 
text(RI$GENDER, RI$RISKPERCEPTIONINDEX1, labels = names(RI$Gender), cex=0.7) 
abline(lm(RI$RISKPERCEPTIONINDEX1 ~ RI$GENDER), lwd=2, col="red")
plot(RI$RACE, RI$RISKPERCEPTIONINDEX1, type="n", xlab= "Race", ylab="RPI scores 1", main= "RPI Scores by Race Wave 1") 
text(RI$RACE, RI$RISKPERCEPTIONINDEX1, labels = names(RI$RACE), cex=0.7)
abline(lm(RI$RISKPERCEPTIONINDEX1 ~ RI$RACE), lwd=2, col="red")
plot(RI$INCOME, RI$RISKPERCEPTIONINDEX1, type="n", xlab= "Income", ylab="RPI scores 1", main= "RPI Scores by Income Wave 1") 
text(RI$INCOME, RI$RISKPERCEPTIONINDEX1, labels = names(RI$INCOME), cex=0.7)
abline(lm(RI$RISKPERCEPTIONINDEX1 ~ RI$INCOME), lwd=2, col="red")
plot(RI$GENDER, RI$RISKPERCEPTIONINDEX7, type="n", xlab= "Gender", ylab="RPI scores 7", main= "RPI Scores by Gender Wave 7") 
text(RI$GENDER, RI$RISKPERCEPTIONINDEX7, labels = names(RI$Gender), cex=0.7)
abline(lm(RI$RISKPERCEPTIONINDEX7 ~ RI$GENDER), lwd=2, col="red")
plot(RI$RACE, RI$RISKPERCEPTIONINDEX7, type="n", xlab= "Race", ylab="RPI scores 7", main= "RPI Scores by Race Wave 7") 
text(RI$RACE, RI$RISKPERCEPTIONINDEX7, labels = names(RI$RACE), cex=0.7)
abline(lm(RI$RISKPERCEPTIONINDEX7 ~ RI$RACE), lwd=2, col="red")
plot(RI$INCOME, RI$RISKPERCEPTIONINDEX7, type="n", xlab= "Income", ylab="RPI scores 7", main= "RPI Scores by Income Wave 7") 
text(RI$INCOME, RI$RISKPERCEPTIONINDEX7, labels = names(RI$INCOME), cex=0.7)
abline(lm(RI$RISKPERCEPTIONINDEX7 ~ RI$INCOME), lwd=2, col="red")
##Wave 3 plots              
```{r Wave 3 plots, echo=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning=FALSE)
plot(RI$GENDER, RI$RISKPERCEPTIONINDEX3, type="n")
text(RI$GENDER, RI$RISKPERCEPTIONINDEX3, cex=0.7)
abline(lm(RI$RISKPERCEPTIONINDEX3 ~ RI$GENDER), lwd=2, col="red")
plot(RI$RACE, RI$RISKPERCEPTIONINDEX3, type="n")
text(RI$RACE, RI$RISKPERCEPTIONINDEX3, cex=0.7)
abline(lm(RI$RISKPERCEPTIONINDEX3 ~ RI$RACE), lwd=2, col="red")
plot(RI$INCOME, RI$RISKPERCEPTIONINDEX3, type="n")
text(RI$INCOME, RI$RISKPERCEPTIONINDEX3, cex=0.7)
abline(lm(RI$RISKPERCEPTIONINDEX3 ~ RI$INCOME), lwd=2, col="red")
##Wave 5 plots     
```{r Wave 5 plots, echo=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning=FALSE)
plot(RI$GENDER, RI$RISKPERCEPTIONINDEX5, type="n")
text(RI$GENDER, RI$RISKPERCEPTIONINDEX5, cex=0.7)
abline(lm(RI$RISKPERCEPTIONINDEX5 ~ RI$GENDER), lwd=2, col="red")
plot(RI$RACE, RI$RISKPERCEPTIONINDEX5, type="n")
text(RI$RACE, RI$RISKPERCEPTIONINDEX5, cex=0.7)
abline(lm(RI$RISKPERCEPTIONINDEX5 ~ RI$RACE), lwd=2, col="red")
plot(RI$INCOME, RI$RISKPERCEPTIONINDEX5, type="n")
text(RI$INCOME, RI$RISKPERCEPTIONINDEX5, cex=0.7)
abline(lm(RI$RISKPERCEPTIONINDEX5 ~ RI$INCOME), lwd=2, col="red")
```
